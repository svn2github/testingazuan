<!-- Copyright (c) 2002 by ObjectLearn. All Rights Reserved. -->
<project name="SpagoBIGeo"  default="deploy"  basedir=".">

  <!-- set global properties for this build -->
  <property file="build.properties"/>
  <property name="dist" value="../../dist" />
  <property name="wardir" value="../../build" />
  <property name="web" value="../" />
  
   
  <target name="init">
    <!-- Create the dist directory structure used by compile
         and copy the deployment descriptors into it-->
    <mkdir dir="${dist}"/>
    <mkdir dir="${dist}/WEB-INF"/>
    <mkdir dir="${dist}/WEB-INF/classes"/>
    <mkdir dir="${dist}/WEB-INF/lib"/>
    <copy todir="${dist}">
      <fileset dir="${web}">
        <include name="**/*.*"/>
        <exclude name="**/WEB-INF/conf/**/*.*"/>
        <exclude name="**/jsp_servlet/*.class"/>
        <exclude name="**/build.xml"/>
        <exclude name="**/build.properties"/>
        <exclude name="**/servers.xml"/>
        <exclude name="**/targets.xml"/>
        <exclude name="**/xercesImpl.jar"/>
        <exclude name="**/xmlParserAPIs.jar"/>
        <exclude name="**/*.war"/>
      </fileset>
    </copy>
    <copy todir="${dist}/WEB-INF/classes">
      <fileset dir="${build}">
        <include name="**/*.*"/>
        <exclude name="**/jsp_servlet/*.class"/>
      </fileset>
    </copy>
    
  </target>


  
  <target name="deploy" depends="undeploy,init" >
	<mkdir dir="${app.conf.dir}"/>
	<mkdir dir="${app.conf.dir}/${war}"/>
	<mkdir dir="${app.conf.dir}/${war}/etc"/>
    <mkdir dir="${app.conf.dir}/${war}/log"/>
    <copy todir="${app.conf.dir}/${war}/etc">
      <fileset dir="${web}/WEB-INF/conf">
        <include name="**/*.*"/>
      </fileset>
    </copy>
    <!-- Create the distribution directory -->
    <delete file="${war}.war"/>
	<jar jarfile="${war}.war" basedir="${dist}"/>    
  	<copy file="${war}.war" todir="${domain}"/>
  	<copy file="${war}.war" todir="${wardir}"/>
  	<delete file="${war}.war"/>
    <!-- Create the distribution directory -->
  	<delete dir="${dist}"/>

  </target>
  

  
  <target name="undeploy">
  	<!-- Create the distribution directory -->
   	<delete file="${domain}/${war}.war"/>

    <delete failonerror="false">
      <fileset dir="${app.conf.dir}/${war}/etc" includes="**/*.*"/>
    </delete>

	<!-- Tomcat -->
   	<delete dir="${domain}/${war}"/>
   	<!-- Tomcat 4.0.x-->
   	<!--delete dir="${serverhome}/work/localhost/${war}"/-->
   	<!-- Tomcat 4.1.x-->
  	<!--delete dir="${serverhome}/work/Standalone/localhost/${war}"/-->

  </target>
  

</project>
